---
import BaseLayout from "../layouts/BaseLayout.astro";

// Combined product data for easier filtering
import { products } from "../data/products";

const testimonials = [
    {
        quote: "Estoy encantado con mi compra. El producto lleg√≥ en perfectas condiciones y exactamente como se describe en la p√°gina.",
        author: "Cristian Guerrero",
        role: "Productor Multimedia",
    },
    {
        quote: "Esta tienda online ofrece una gran variedad de productos de alta calidad. He realizado m√∫ltiples compras y siempre he quedado satisfecho.",
        author: "Fernando Castillo",
        role: "Deportista ‚Äì Coach",
    },
    {
        quote: "No puedo creer lo bueno que es este sitio web. F√°cil de navegar, proceso de compra sin complicaciones y un servicio de entrega r√°pido.",
        author: "Maicol Garz√≥n",
        role: "Fot√≥grafo",
    },
];

const star = `M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z`;
---

<BaseLayout
    title="Tienda Digital | Mateo Ferrer"
    description="Explora nuestra selecci√≥n de productos digitales, plantillas, e-books y servicios tecnol√≥gicos exclusivos. Potencia tu productividad y creatividad."
>
    <!-- SEO Schema -->
    <script
        type="application/ld+json"
        set:html={JSON.stringify({
            "@context": "https://schema.org",
            "@type": "ItemList",
            itemListElement: products.map((product, index) => ({
                "@type": "ListItem",
                position: index + 1,
                url: `https://mateoferrer.com/shop/#product-${product.id}`,
                name: product.name,
                image: `https://mateoferrer.com${product.image}`,
                description: product.description,
                offers: {
                    "@type": "Offer",
                    priceCurrency: "COP",
                    price: product.price.replace(/[^0-9]/g, "") || "0",
                },
            })),
        })}
    />

    <div class="main-container">
        <!-- Floating Cart Button -->
        <button id="cart-toggle" class="cart-float-btn" aria-label="Open Cart">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
            >
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path
                    d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
                ></path>
            </svg>
            <span id="cart-count">0</span>
        </button>

        <!-- Cart Sidebar -->
        <div id="cart-sidebar" class="cart-sidebar">
            <div class="cart-header">
                <h2>Tu Carrito</h2>
                <button id="cart-close" class="close-btn">&times;</button>
            </div>
            <div id="cart-items" class="cart-items">
                <!-- Items injected by JS -->
                <p class="empty-msg">Tu carrito est√° vac√≠o.</p>
            </div>
            <div class="cart-footer">
                <div class="cart-total">
                    <span>Total Estimado:</span>
                    <span id="cart-total-price">$0</span>
                </div>
                <a
                    href="https://wa.me/573005059987"
                    target="_blank"
                    class="checkout-btn">Cotizar por WhatsApp</a
                >
            </div>
        </div>
        <div id="cart-overlay" class="cart-overlay"></div>
        <div id="toast-container" class="toast-container"></div>

        <!-- Product Details Modal -->
        <div id="product-modal" class="modal-overlay">
            <div class="modal-content glass-panel">
                <button id="modal-close" class="modal-close">&times;</button>
                <div class="modal-body">
                    <div class="modal-image">
                        <img id="modal-img" src="" alt="Product" />
                    </div>
                    <div class="modal-details">
                        <span id="modal-category" class="modal-pill">APP</span>
                        <h2 id="modal-title">Product Title</h2>
                        <p id="modal-price" class="modal-price">$0</p>
                        <p id="modal-description" class="modal-desc">
                            Description goes here.
                        </p>
                        <div class="modal-actions">
                            <button id="modal-add-btn" class="primary-btn"
                                >Agregar al Carrito</button
                            >
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Hero Section -->
        <section class="shop-hero">
            <div class="hero-bg-glow"></div>
            <div class="hero-content fade-in-up">
                <span class="badge-premium">NUEVO LANZAMIENTO</span>
                <h1>Tienda Digital & Servicios</h1>
                <p class="hero-text">
                    Recursos premium para creadores, desarrolladores y
                    emprendedores. Desde <span class="highlight"
                        >plantillas de Notion</span
                    > hasta <span class="highlight">asesor√≠as tech</span>.
                </p>
                <!-- Search Bar -->
                <div class="search-wrapper">
                    <div class="search-container glass-input">
                        <input
                            type="text"
                            id="product-search"
                            placeholder="¬øQu√© est√°s buscando hoy?"
                        />
                        <button class="search-btn">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            >
                                <circle cx="11" cy="11" r="8"></circle>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"
                                ></line>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Categories Filter -->
        <section class="catalog-section" id="catalog">
            <div class="section-header fade-in">
                <h2>Explora el Cat√°logo</h2>
                <div class="filters-container hide-scrollbar">
                    <button class="filter-btn active" data-filter="all"
                        >Todo</button
                    >
                    <button class="filter-btn" data-filter="templates"
                        >Plantillas</button
                    >
                    <button class="filter-btn" data-filter="ebooks"
                        >E-books</button
                    >
                    <button class="filter-btn" data-filter="education"
                        >Cursos</button
                    >
                    <button class="filter-btn" data-filter="apps">Apps</button>
                    <button class="filter-btn" data-filter="gaming"
                        >Gaming</button
                    >
                    <button class="filter-btn" data-filter="tech">Tech</button>
                    <button class="filter-btn" data-filter="design"
                        >Dise√±o</button
                    >
                </div>
            </div>

            <div class="products-grid" id="products-grid">
                {
                    products.map((product) => (
                        <div
                            class="product-card glass-card fade-in-item"
                            data-category={product.category}
                            data-name={product.name.toLowerCase()}
                            id={`product-${product.id}`}
                        >
                            <div class="image-wrapper">
                                <img
                                    src={product.image}
                                    alt={product.name}
                                    loading="lazy"
                                    onerror="this.src='/assets/placeholder.png'"
                                />
                                <div class="overlay">
                                    <button
                                        class="wishlist-btn"
                                        data-id={product.id}
                                        aria-label="Agregar a favoritos"
                                    >
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="20"
                                            height="20"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            class="heart-icon"
                                        >
                                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
                                        </svg>
                                    </button>
                                    <button
                                        class="add-cart-btn"
                                        data-id={product.id}
                                        data-name={product.name}
                                        data-price={product.price}
                                        data-image={product.image}
                                    >
                                        Agregar +
                                    </button>
                                </div>
                            </div>
                            <div
                                class="content product-trigger"
                                data-id={product.id}
                            >
                                <div class="card-meta">
                                    <span
                                        class={`category-tag tag-${product.category}`}
                                    >
                                        {product.category.toUpperCase()}
                                    </span>
                                </div>
                                <h4>{product.name}</h4>
                                <p class="price">{product.price}</p>
                            </div>
                        </div>
                    ))
                }
            </div>
            <p
                id="no-results"
                style="display:none; text-align:center; margin-top: 4rem; font-size: 1.2rem; color: var(--text-muted);"
            >
                No encontramos lo que buscas. ¬øIntenta con otra categor√≠a?
            </p>
        </section>

        <!-- Features Banner -->
        <section class="features-banner glass-panel">
            <div class="banner-item">
                <div class="icon">‚ö°</div>
                <h3>Entrega Digital</h3>
                <p>Acceso inmediato a tus archivos y plantillas.</p>
            </div>
            <div class="banner-item">
                <div class="icon">üõ°Ô∏è</div>
                <h3>Garant√≠a Total</h3>
                <p>Soporte dedicado y actualizaciones futuras.</p>
            </div>
            <div class="banner-item">
                <div class="icon">üí≥</div>
                <h3>Pagos Flexibles</h3>
                <p>Nequi, Daviplata, Bancolombia y m√°s.</p>
            </div>
        </section>

        <!-- Testimonials -->
        <section class="testimonials-section">
            <h2 class="section-title">Clientes Felices</h2>
            <div class="testimonials-grid">
                {
                    testimonials.map((testimonial) => (
                        <div class="testimonial-card glass-card">
                            <div class="stars">
                                {Array(5)
                                    .fill(0)
                                    .map(() => (
                                        <svg
                                            class="star-icon"
                                            viewBox="0 0 24 24"
                                        >
                                            <path d={star} />
                                        </svg>
                                    ))}
                            </div>
                            <p class="quote">"{testimonial.quote}"</p>
                            <div class="author-info">
                                <p class="author">{testimonial.author}</p>
                                <p class="role">{testimonial.role}</p>
                            </div>
                        </div>
                    ))
                }
            </div>
        </section>

        <!-- Contact CTA -->
        <section class="cta-section">
            <div class="cta-content glass-panel">
                <h2>¬øNecesitas algo a la medida?</h2>
                <p>
                    Desarrollamos soluciones de software y dise√±o espec√≠ficas
                    para ti.
                </p>
                <a
                    href="mailto:contact@mateoferrer.com"
                    class="primary-btn glow-effect">Contactar Ahora</a
                >
            </div>
        </section>
    </div>
</BaseLayout>

<script>
    // --- APP LOGIC ---
    import { products } from "../data/products";

    interface Product {
        id: string | number;
        name: string;
        price: string;
        image: string;
        description?: string;
        category: string;
        tags: string[];
    }

    interface CartItem extends Product {
        quantity: number;
    }

    let cart: CartItem[] = JSON.parse(
        localStorage.getItem("mf_shop_cart") || "[]",
    );

    let wishlist: (string | number)[] = JSON.parse(
        localStorage.getItem("mf_shop_wishlist") || "[]",
    );

    // Selectors
    const cartToggle = document.getElementById("cart-toggle");
    const cartSidebar = document.getElementById("cart-sidebar");
    const cartOverlay = document.getElementById("cart-overlay");
    const cartClose = document.getElementById("cart-close");
    const cartItemsContainer = document.getElementById("cart-items");
    const cartCount = document.getElementById("cart-count");
    const addButtons = document.querySelectorAll(".add-cart-btn");
    const searchInput = document.getElementById(
        "product-search",
    ) as HTMLInputElement | null;
    const filterBtns = document.querySelectorAll(".filter-btn");
    const productCards = document.querySelectorAll(".product-card");
    const toastContainer = document.getElementById("toast-container");

    // Modal Selectors
    const modal = document.getElementById("product-modal");
    const modalClose = document.getElementById("modal-close");
    const modalImg = document.getElementById("modal-img") as HTMLImageElement;
    const modalTitle = document.getElementById("modal-title");
    const modalPrice = document.getElementById("modal-price");
    const modalDesc = document.getElementById("modal-description");
    const modalCategory = document.getElementById("modal-category");
    const modalAddBtn = document.getElementById("modal-add-btn");
    const productTriggers = document.querySelectorAll(".product-trigger");

    // Wishlist Selectors
    const wishlistBtns = document.querySelectorAll(".wishlist-btn");

    // --- TOAST FUNCTIONS ---
    function showToast(message: string, type: "success" | "error" = "success") {
        if (!toastContainer) return;

        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.innerHTML = `
            <div class="toast-content">
                <span class="toast-icon">${type === "success" ? "‚úÖ" : "‚ùå"}</span>
                <span class="toast-message">${message}</span>
            </div>
        `;

        toastContainer.appendChild(toast);

        // Trigger animation
        requestAnimationFrame(() => {
            toast.classList.add("show");
        });

        setTimeout(() => {
            toast.classList.remove("show");
            setTimeout(() => {
                toast.remove();
            }, 300);
        }, 3000);
    }

    // --- CART FUNCTIONS ---
    function updateCartUI() {
        // Update badge
        if (cartCount) {
            const totalItems = cart.reduce(
                (acc, item) => acc + item.quantity,
                0,
            );
            cartCount.textContent = totalItems.toString();
        }

        if (!cartItemsContainer) return;

        // Render items
        if (cart.length === 0) {
            cartItemsContainer.innerHTML =
                '<p class="empty-msg">Tu carrito est√° vac√≠o.</p>';
        } else {
            cartItemsContainer.innerHTML = cart
                .map(
                    (item: CartItem, index: number) => `
                <div class="cart-item">
                    <img src="${item.image}" alt="${item.name}" />
                    <div class="cart-item-info">
                        <h5>${item.name}</h5>
                        <p>${item.price}</p>
                        <div class="quantity-controls">
                            <button class="qty-btn minus" data-id="${item.id}">-</button>
                            <span>${item.quantity}</span>
                            <button class="qty-btn plus" data-id="${item.id}">+</button>
                        </div>
                    </div>
                     <button class="remove-btn" data-id="${item.id}">&times;</button>
                </div>
            `,
                )
                .join("");

            // Add event listeners
            document.querySelectorAll(".qty-btn").forEach((btn) => {
                btn.addEventListener("click", (e) => {
                    const target = e.target as HTMLElement;
                    const id = target.getAttribute("data-id");
                    if (id) {
                        if (target.classList.contains("plus")) {
                            updateQuantity(id, 1);
                        } else {
                            updateQuantity(id, -1);
                        }
                    }
                });
            });

            document.querySelectorAll(".remove-btn").forEach((btn) => {
                btn.addEventListener("click", (e) => {
                    const target = e.target as HTMLElement;
                    const id = target.getAttribute("data-id");
                    if (id) removeFromCart(id);
                });
            });
        }

        // Calculate Total
        let total = 0;
        cart.forEach((item) => {
            // Remove '$', '.', and non-numeric chars except for digits.
            // Assume format like "$50.000 / A√±o" -> 50000
            const priceString = item.price.replace(/[^0-9]/g, "");
            const priceVal = parseInt(priceString);
            if (!isNaN(priceVal)) {
                total += priceVal * item.quantity;
            }
        });

        const totalFormatted = "$" + total.toLocaleString("es-CO");
        const cartTotalEl = document.getElementById("cart-total-price");
        if (cartTotalEl) {
            cartTotalEl.textContent = totalFormatted;
        }

        // Save
        localStorage.setItem("mf_shop_cart", JSON.stringify(cart));

        // Update WhatsApp Link
        const checkoutBtn = document.querySelector(
            ".checkout-btn",
        ) as HTMLAnchorElement;
        if (checkoutBtn) {
            if (cart.length > 0) {
                const itemsList = cart
                    .map(
                        (item) =>
                            `- ${item.quantity}x ${item.name} (${item.price})`,
                    )
                    .join("%0A");

                const message = `Hola Mateo, estoy interesado en cotizar los siguientes productos:%0A%0A${itemsList}%0A%0ATotal estimado: ${totalFormatted}`;
                checkoutBtn.href = `https://wa.me/573005059987?text=${message}`;
                checkoutBtn.style.pointerEvents = "auto";
                checkoutBtn.style.opacity = "1";
            } else {
                checkoutBtn.href = "#";
                checkoutBtn.style.pointerEvents = "none";
                checkoutBtn.style.opacity = "0.5";
            }
        }
    }

    function addToCart(product: Product) {
        const existingItem = cart.find((item) => item.id === product.id);

        if (existingItem) {
            existingItem.quantity += 1;
            showToast(`Se aument√≥ la cantidad de <b>${product.name}</b>`);
        } else {
            cart.push({ ...product, quantity: 1 });
            showToast(`<b>${product.name}</b> agregado al carrito`);
        }

        updateCartUI();

        // Open cart feedback
        if (cartSidebar) cartSidebar.classList.add("open");
        if (cartOverlay) cartOverlay.classList.add("open");
    }

    function updateQuantity(id: string, change: number) {
        const itemIndex = cart.findIndex((item) => item.id === id);
        if (itemIndex > -1) {
            const newQuantity = cart[itemIndex].quantity + change;
            if (newQuantity > 0) {
                cart[itemIndex].quantity = newQuantity;
            } else {
                // If quantity goes to 0, ask to remove or just remove
                cart.splice(itemIndex, 1);
            }
            updateCartUI();
        }
    }

    function removeFromCart(id: string) {
        cart = cart.filter((item) => item.id !== id);
        updateCartUI();
    }

    // Event Listeners
    if (cartToggle) {
        cartToggle.addEventListener("click", () => {
            if (cartSidebar) cartSidebar.classList.add("open");
            if (cartOverlay) cartOverlay.classList.add("open");
        });
    }

    function closeCart() {
        if (cartSidebar) cartSidebar.classList.remove("open");
        if (cartOverlay) cartOverlay.classList.remove("open");
    }

    if (cartClose) cartClose.addEventListener("click", closeCart);
    if (cartOverlay) cartOverlay.addEventListener("click", closeCart);

    addButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
            const product: Product = {
                id: btn.getAttribute("data-id") || "",
                name: btn.getAttribute("data-name") || "",
                price: btn.getAttribute("data-price") || "",
                image: btn.getAttribute("data-image") || "",
                category: "",
                tags: [],
            };
            addToCart(product);
        });
    });

    // --- SEARCH & FILTER LOGIC ---
    function filterProducts() {
        if (!searchInput) return;
        const query = searchInput.value.toLowerCase();

        const activeBtn = document.querySelector(".filter-btn.active");
        const activeCategory = activeBtn
            ? activeBtn.getAttribute("data-filter")
            : "all";

        let visibleCount = 0;

        productCards.forEach((card) => {
            const name = card.getAttribute("data-name") || "";
            const category = card.getAttribute("data-category") || "";

            const matchQuery = name.includes(query);
            const matchCategory =
                activeCategory === "all" || category === activeCategory;

            if (matchQuery && matchCategory) {
                (card as HTMLElement).style.display = "block";
                visibleCount++;
            } else {
                (card as HTMLElement).style.display = "none";
            }
        });

        const noResults = document.getElementById("no-results");
        if (noResults) {
            if (visibleCount === 0) {
                noResults.style.display = "block";
            } else {
                noResults.style.display = "none";
            }
        }
    }

    if (searchInput) searchInput.addEventListener("input", filterProducts);

    filterBtns.forEach((btn) => {
        btn.addEventListener("click", () => {
            filterBtns.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            filterProducts();
        });
    });

    // --- MODAL FUNCTIONS ---
    function openModal(productId: string | number) {
        const product = products.find((p) => p.id == productId);
        if (!product || !modal) return;

        if (modalImg) modalImg.src = product.image;
        if (modalTitle) modalTitle.textContent = product.name;
        if (modalPrice) modalPrice.textContent = product.price;
        if (modalCategory)
            modalCategory.textContent = product.category.toUpperCase();
        if (modalDesc)
            modalDesc.textContent =
                product.description || "Sin descripci√≥n disponible.";

        // Update Add Button in Modal
        if (modalAddBtn) {
            // Clone to remove old listeners
            const newBtn = modalAddBtn.cloneNode(true);
            modalAddBtn.parentNode?.replaceChild(newBtn, modalAddBtn);
            newBtn.addEventListener("click", () => {
                addToCart(product);
                if (modal) modal.classList.remove("open");
            });
        }

        modal.classList.add("open");
    }

    if (modalClose) {
        modalClose.addEventListener("click", () => {
            if (modal) modal.classList.remove("open");
        });
    }

    // Close on click outside
    if (modal) {
        modal.addEventListener("click", (e) => {
            if (e.target === modal) modal.classList.remove("open");
        });
    }

    productTriggers.forEach((trigger) => {
        trigger.addEventListener("click", () => {
            const id = trigger.getAttribute("data-id");
            if (id) openModal(id);
        });
    });

    // --- WISHLIST FUNCTIONS ---
    function toggleWishlist(id: string | number) {
        const index = wishlist.indexOf(id);
        if (index === -1) {
            wishlist.push(id);
            showToast("Agregado a favoritos");
        } else {
            wishlist.splice(index, 1);
            showToast("Eliminado de favoritos");
        }
        localStorage.setItem("mf_shop_wishlist", JSON.stringify(wishlist));
        updateWishlistUI();
    }

    function updateWishlistUI() {
        wishlistBtns.forEach((btn) => {
            const id = btn.getAttribute("data-id");
            // Check loosely for number/string match
            if (id && wishlist.some((wId) => wId == id)) {
                btn.classList.add("active");
                const icon = btn.querySelector(".heart-icon");
                if (icon) icon.setAttribute("fill", "currentColor");
            } else {
                btn.classList.remove("active");
                const icon = btn.querySelector(".heart-icon");
                if (icon) icon.setAttribute("fill", "none");
            }
        });
    }

    wishlistBtns.forEach((btn) => {
        btn.addEventListener("click", (e) => {
            e.stopPropagation(); // Prevent card click
            const id = btn.getAttribute("data-id");
            if (id) toggleWishlist(parseInt(id) || id);
        });
    });

    // Init
    updateCartUI();
    updateWishlistUI();
</script>

<style>
    /* Variables & Reset */
    :root {
        --primary: #8b5cf6;
        --secondary: #4c1d95;
        --accent: #d946ef;
        --surface: #ffffff;
        --glass-bg: rgba(255, 255, 255, 0.1);
        --glass-border: rgba(255, 255, 255, 0.2);
        --text-main: var(--gray-100);
        --text-muted: var(--gray-400);
        --radius: 20px;
        --shadow-sm:
            0 4px 6px -1px rgba(0, 0, 0, 0.1),
            0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg:
            0 10px 15px -3px rgba(0, 0, 0, 0.1),
            0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --glow: 0 0 20px rgba(139, 92, 246, 0.5);
    }

    :global(.theme-dark) {
        --glass-bg: rgba(17, 24, 39, 0.4);
        --glass-border: rgba(255, 255, 255, 0.1);
        --text-main: #f3f4f6;
        --text-muted: #9ca3af;
    }

    /* Animations */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes pulseGlow {
        0%,
        100% {
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
        }
        50% {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.6);
        }
    }

    @keyframes float {
        0% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-10px);
        }
        100% {
            transform: translateY(0px);
        }
    }

    .fade-in-up {
        animation: fadeInUp 0.8s ease-out forwards;
    }

    .fade-in {
        animation: fadeInUp 1s ease-out forwards;
    }

    /* Glassmorphism Utilities */
    .glass-panel {
        background: var(--glass-bg);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius);
        box-shadow: var(--shadow-lg);
    }

    .glass-card {
        background: var(--glass-bg);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius);
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .glass-input {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(4px);
        border: 1px solid var(--glass-border);
        border-radius: 50px;
    }

    /* Layout */
    .main-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 1.5rem 4rem;
        position: relative;
    }

    /* Hero Section */
    .shop-hero {
        position: relative;
        min-height: 60vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 4rem 1rem;
        overflow: hidden;
        margin-bottom: 3rem;
    }

    .hero-bg-glow {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image:
            radial-gradient(
                circle at 50% 50%,
                rgba(139, 92, 246, 0.15) 0%,
                rgba(0, 0, 0, 0) 70%
            ),
            url("/assets/shop-hero.png");
        background-repeat: no-repeat;
        background-position: center center;
        background-size: cover;
        pointer-events: none;
        z-index: -1;
        opacity: 0.6;
    }

    .hero-content {
        max-width: 800px;
        z-index: 2;
    }

    .badge-premium {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: linear-gradient(90deg, var(--primary), var(--accent));
        color: white;
        border-radius: 50px;
        font-weight: 700;
        font-size: 0.8rem;
        letter-spacing: 1px;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 15px rgba(217, 70, 239, 0.4);
    }

    .shop-hero h1 {
        font-size: clamp(2.5rem, 5vw, 4.5rem);
        line-height: 1.1;
        margin-bottom: 1.5rem;
        background: linear-gradient(to right, #fff, #a78bfa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        /* Fallback for light mode override if needed via global theme css */
    }

    :global(.theme-light) .shop-hero h1 {
        background: linear-gradient(to right, #1f2937, #7c3aed);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .hero-text {
        font-size: 1.25rem;
        color: var(--text-muted);
        margin-bottom: 2.5rem;
        line-height: 1.6;
    }

    .highlight {
        color: var(--accent);
        font-weight: 600;
    }

    /* Search Bar */
    .search-wrapper {
        display: flex;
        justify-content: center;
        width: 100%;
    }

    .search-container {
        display: flex;
        align-items: center;
        width: 100%;
        max-width: 500px;
        padding: 0.5rem;
        transition:
            transform 0.3s ease,
            box-shadow 0.3s ease;
    }

    .search-container:focus-within {
        transform: scale(1.02);
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        border-color: var(--primary);
    }

    .search-container input {
        flex: 1;
        background: transparent;
        border: none;
        padding: 0.8rem 1.5rem;
        color: var(--text-main);
        font-size: 1rem;
        outline: none;
    }

    .search-btn {
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background 0.3s ease;
    }

    .search-btn:hover {
        background: var(--accent);
    }

    /* Catalog Section */
    .section-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
        margin-bottom: 3rem;
    }

    .filters-container {
        display: flex;
        gap: 0.8rem;
        flex-wrap: nowrap;
        overflow-x: auto;
        padding: 0.5rem;
        width: 100%;
        max-width: 100%;
        justify-content: flex-start;
        -webkit-overflow-scrolling: touch;
    }

    @media (min-width: 768px) {
        .filters-container {
            justify-content: center;
            flex-wrap: wrap;
        }
    }

    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    .filter-btn {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--glass-border);
        color: var(--text-muted);
        padding: 0.6rem 1.2rem;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        white-space: nowrap;
        font-weight: 500;
        backdrop-filter: blur(4px);
    }

    .filter-btn:hover,
    .filter-btn.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
        box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        transform: translateY(-2px);
    }

    /* Grid */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 2rem;
        margin-bottom: 4rem;
    }

    .product-card {
        display: flex;
        flex-direction: column;
        height: 100%;
        position: relative;
    }

    .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.2);
        border-color: var(--primary);
    }

    .image-wrapper {
        position: relative;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 16px;
        margin: 0.8rem;
        background: var(--gray-800);
    }

    .image-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }

    .product-card:hover .image-wrapper img {
        transform: scale(1.1);
    }

    .overlay {
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s ease;
        backdrop-filter: blur(2px);
    }

    .product-card:hover .overlay {
        opacity: 1;
    }

    .wishlist-btn {
        background: white;
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.2s;
        color: #ef4444;
    }

    .wishlist-btn:hover {
        transform: scale(1.1);
    }

    .wishlist-btn.active .heart-icon {
        fill: #ef4444;
    }

    .add-cart-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 30px;
        font-weight: 600;
        cursor: pointer;
        transform: translateY(20px);
        transition: all 0.3s ease;
    }

    .product-card:hover .add-cart-btn {
        transform: translateY(0);
    }

    .add-cart-btn:hover {
        background: var(--accent);
    }

    .content {
        padding: 0 1.5rem 1.5rem;
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .card-meta {
        margin-bottom: 0.5rem;
    }

    .category-tag {
        font-size: 0.7rem;
        font-weight: bold;
        padding: 0.2rem 0.6rem;
        border-radius: 4px;
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-muted);
    }

    /* Tag Colors */
    .tag-templates {
        color: #3b82f6;
        background: rgba(59, 130, 246, 0.1);
    }
    .tag-ebooks {
        color: #10b981;
        background: rgba(16, 185, 129, 0.1);
    }
    .tag-education {
        color: #f59e0b;
        background: rgba(245, 158, 11, 0.1);
    }
    .tag-marketing {
        color: #ec4899;
        background: rgba(236, 72, 153, 0.1);
    }

    .content h4 {
        margin: 0.5rem 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-main);
    }

    .content .price {
        margin-top: auto;
        color: var(--accent);
        font-weight: 700;
        font-size: 1.1rem;
    }

    /* Features Banner */
    .features-banner {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        padding: 3rem;
        margin-bottom: 4rem;
    }

    .banner-item {
        text-align: center;
        padding: 1rem;
    }

    .banner-item .icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        display: inline-block;
        animation: float 3s ease-in-out infinite;
    }
    .banner-item:nth-child(2) .icon {
        animation-delay: 1s;
    }
    .banner-item:nth-child(3) .icon {
        animation-delay: 2s;
    }

    .banner-item h3 {
        color: var(--text-main);
        margin-bottom: 0.5rem;
    }

    .banner-item p {
        color: var(--text-muted);
        font-size: 0.9rem;
    }

    /* Testimonials */
    .testimonials-section {
        margin-bottom: 4rem;
    }

    .section-title {
        text-align: center;
        margin-bottom: 3rem;
        font-size: 2rem;
        background: linear-gradient(90deg, var(--text-main), var(--text-muted));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .testimonials-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }

    .testimonial-card {
        padding: 2rem;
    }

    .stars {
        color: #fbbf24;
        margin-bottom: 1rem;
    }

    .star-icon {
        width: 20px;
        height: 20px;
        fill: currentColor;
    }

    .quote {
        font-style: italic;
        margin-bottom: 1.5rem;
        color: var(--text-muted);
        line-height: 1.6;
    }

    .author-info .author {
        font-weight: 700;
        color: var(--text-main);
    }

    .author-info .role {
        font-size: 0.85rem;
        color: var(--primary);
    }

    /* CTA Section */
    .cta-section {
        display: flex;
        justify-content: center;
    }

    .cta-content {
        padding: 4rem 2rem;
        text-align: center;
        width: 100%;
        max-width: 900px;
        position: relative;
        overflow: hidden;
    }

    .cta-content::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            45deg,
            rgba(139, 92, 246, 0.1),
            rgba(217, 70, 239, 0.1)
        );
        z-index: -1;
    }

    .cta-content h2 {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: var(--text-main);
    }

    .cta-content p {
        font-size: 1.2rem;
        color: var(--text-muted);
        margin-bottom: 2rem;
    }

    .primary-btn {
        display: inline-block;
        background: var(--primary);
        color: white;
        padding: 1rem 2.5rem;
        border-radius: 50px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
    }

    .primary-btn.glow-effect {
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
    }

    .primary-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 30px rgba(139, 92, 246, 0.8);
        background: var(--accent);
    }

    /* Cart Floating & Sidebar */
    .cart-float-btn {
        position: fixed;
        bottom: 7rem;
        right: 2rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 50%;
        width: 65px;
        height: 65px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 25px rgba(139, 92, 246, 0.5);
        z-index: 1000;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .cart-float-btn:hover {
        transform: scale(1.1) rotate(10deg);
    }

    #cart-count {
        position: absolute;
        top: 0;
        right: 0;
        background: #ef4444;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        border: 2px solid white;
    }

    .cart-sidebar {
        position: fixed;
        top: 0;
        right: -450px;
        width: 100%;
        max-width: 420px;
        height: 100vh;
        background: var(--surface);
        box-shadow: -10px 0 40px rgba(0, 0, 0, 0.3);
        z-index: 1002;
        transition: right 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        display: flex;
        flex-direction: column;
        padding: 2rem;
    }

    :global(.theme-dark) .cart-sidebar {
        background: #0f172a;
        border-left: 1px solid var(--glass-border);
    }

    .cart-sidebar.open {
        right: 0;
    }

    .cart-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1001;
        display: none;
        backdrop-filter: blur(4px);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .cart-overlay.open {
        display: block;
        opacity: 1;
    }

    .cart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        border-bottom: 1px solid var(--glass-border);
        padding-bottom: 1rem;
    }

    .close-btn {
        background: none;
        border: none;
        font-size: 2rem;
        color: var(--text-muted);
        cursor: pointer;
        transition: color 0.3s;
    }

    .close-btn:hover {
        color: var(--text-main);
    }

    .cart-items {
        flex: 1;
        overflow-y: auto;
        padding-right: 0.5rem;
    }

    .cart-item {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid var(--glass-border);
        animation: fadeInUp 0.3s ease;
    }

    .cart-item img {
        width: 70px;
        height: 70px;
        object-fit: cover;
        border-radius: 10px;
    }

    .cart-item-info h5 {
        font-size: 1rem;
        margin-bottom: 0.2rem;
        color: var(--text-main);
    }

    .cart-total {
        font-size: 1.25rem;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        margin-bottom: 1.5rem;
        color: var(--text-main);
    }

    .checkout-btn {
        display: block;
        background: #25d366; /* WhatsApp Green */
        color: white;
        text-align: center;
        padding: 1rem;
        border-radius: 12px;
        text-decoration: none;
        font-weight: bold;
        transition: opacity 0.3s;
    }

    .checkout-btn:hover {
        opacity: 0.9;
    }

    /* Modal */
    .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.8);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        backdrop-filter: blur(8px);
        padding: 1rem;
    }

    .modal-overlay.open {
        opacity: 1;
        visibility: visible;
    }

    .modal-content {
        width: 100%;
        max-width: 900px;
        max-height: 90vh;
        overflow-y: auto;
        padding: 0;
        position: relative;
        transform: scale(0.9);
        transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .modal-overlay.open .modal-content {
        transform: scale(1);
    }

    .modal-body {
        display: flex;
        flex-direction: column;
    }

    @media (min-width: 768px) {
        .modal-body {
            flex-direction: row;
        }
    }

    .modal-image {
        flex: 1;
        min-height: 300px;
    }

    .modal-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .modal-details {
        flex: 1;
        padding: 2.5rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .modal-close {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        cursor: pointer;
        z-index: 10;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .modal-pill {
        display: inline-block;
        background: var(--primary);
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        margin-bottom: 1rem;
        align-self: flex-start;
    }

    .modal-details h2 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        color: var(--text-main);
    }

    .modal-price {
        font-size: 1.5rem;
        color: var(--accent);
        font-weight: bold;
        margin-bottom: 1.5rem;
    }

    .modal-desc {
        color: var(--text-muted);
        line-height: 1.7;
        margin-bottom: 2rem;
    }

    /* Toast */
    .toast-container {
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        z-index: 3000;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .toast {
        background: var(--glass-bg);
        color: var(--text-main);
        padding: 1rem 1.5rem;
        border-radius: 50px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        gap: 1rem;
        backdrop-filter: blur(10px);
        border: 1px solid var(--glass-border);
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
    }

    .toast.show {
        opacity: 1;
        transform: translateY(0);
    }

    /* Responsive */
    @media (max-width: 640px) {
        .shop-hero h1 {
            font-size: 2.5rem;
        }
        .hero-bg-glow {
            width: 100vw;
            height: 100vw;
        }
        .products-grid {
            grid-template-columns: 1fr;
        }
        .feature-banner {
            grid-template-columns: 1fr;
        }
    }
</style>
